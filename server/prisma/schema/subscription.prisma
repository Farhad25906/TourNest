model SubscriptionPlan {
    id            String   @id @default(uuid())
    name          String   // Basic, Standard, Premium
    description   String
    price         Float    // USD price (converted from BDT: Basic=0, Standard=$4.50, Premium=$9)
    duration      Int      @default(12) // 12 months (1 year)
    tourLimit     Int      // 4, 8, 12 tours per year
    canWriteBlogs Boolean  @default(false) // Basic: false, Standard/Premium: true
    blogPostLimit Int?     // Standard: 10, Premium: unlimited (null)
    features      String[]
    isActive      Boolean  @default(true)
    createdAt     DateTime @default(now())
    updatedAt     DateTime @updatedAt

    subscriptions Subscription[]
    payments      Payment[]

    @@map("subscription_plans")
}

model Subscription {
    id                 String             @id @default(uuid())
    hostId             String
    planId             String
    startDate          DateTime
    endDate            DateTime
    status             SubscriptionStatus @default(PENDING)
    autoRenew          Boolean            @default(true)
    tourLimit          Int
    remainingTours     Int
    blogPostsAllowed   Boolean
    blogPostLimit      Int?
    remainingBlogPosts Int?
    createdAt          DateTime           @default(now())
    updatedAt          DateTime           @updatedAt

    host     Host             @relation(fields: [hostId], references: [id])
    plan     SubscriptionPlan @relation(fields: [planId], references: [id])
    payments Payment[]

    @@map("subscriptions")
}

model Payment {
    id              String        @id @default(uuid())
    userId          String
    bookingId       String?
    subscriptionId  String?
    amount          Float         // USD amount
    currency        String        @default("USD")
    paymentMethod   PaymentMethod
    status          PaymentStatus @default(PENDING)
    transactionId   String?
    paymentGateway  String        // stripe, bkash, nagad, bank_transfer
    gatewayResponse Json?
    paidAt          DateTime?
    createdAt       DateTime      @default(now())
    updatedAt       DateTime      @updatedAt

    user               User              @relation(fields: [userId], references: [id])
    booking            Booking?          @relation(fields: [bookingId], references: [id])
    subscription       Subscription?     @relation(fields: [subscriptionId], references: [id])
    subscriptionPlan   SubscriptionPlan? @relation(fields: [subscriptionPlanId], references: [id])
    subscriptionPlanId String?

    @@map("payments")
}
